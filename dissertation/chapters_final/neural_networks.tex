%==================================================================================================
\FloatBarrier
\chapter{Neural networks}

In this chapter attention will be given to artificial neural networks (ANN) which are one of most 
popular data processing models in self learning systems \cite{Abiodun2019} \cite{Tran2021}
\cite{Syed2021}. First focus will be given to biological neural networks, that will be referred 
to as a neural circuits (NC) in order to be consistent with nomenclature \cite{Purves2001} as 
well as to avoid confusion with ANN.  
After that an electrical models of NC will be shortly described and finally a mathematical models
that are used in modern ANN solutions will be discussed. Special attention will be given to 
computational complexity of both running and teaching described ANN models. 



%==================================================================================================
\FloatBarrier
\section{Basic concepts}

%--------------------------------------------------------------------------------------------------
\FloatBarrier
\subsection{Biological networks}
The subject of artificial neural networks belongs to the interdisciplinary field of research 
related to biocybernetics, electronics, applied mathematics, automation, and even medicine.
Artificial neural networks were created based on knowledge about the functioning of the nervous
system of living creatures and are an attempt to use the phenomena occurring in nervous systems
in the search for new technological solutions.
The nerve cell, or neuron for short, is the basic component of the nervous system.
Understanding the mechanisms of operation of individual neurons and their interaction is 
particularly important for understanding the processes of acquiring, transmitting, processing,
and using information running in neural networks.
For this reason, the real neuron model is extremely important. Like any other cell, a neuron has
a body with cytological equipment called a soma, inside which is a nucleus.
From the soma of the neuron - numerous projections play an important role in connection with
other cells.
Two types of projections can be distinguished: numerous, thin, and densely branched dendrites
and a thicker axon, forking at the end.
Input signals go to the cell via synapses, and the output signal goes through the axon
and its numerous branches called collateral.
The collaterals reach the soma and dendrites of other neurons to form more synapses. 
Synapses that connect the outputs of other nerve cells to a given cell can therefore be found
both on the dendrites and directly on the cell body.
The transmission of signals inside the nervous system is a complex chemical-electrical process. 
In simplified terms, it can be assumed that the transmission of the nerve impulse from one cell to
another is based on the secretion of special chemical substances under the influence of stimuli 
coming from synapses.

These substances act on the cell membrane to cause a change in its electric potential, 
the change being stronger the more neuro mediators appear on the cell membrane.
Individual synapses differ in size and the ability to accumulate neuro mediators near the synaptic
membrane. 
For this reason, the same impulse reaching the cell's input via a specific synapse may cause a
stronger or weaker excitation of the cell than in the case of another input.
The degree of cell excitation is measured by the degree of its membrane polarization,
which depends on the total amount of neuro mediators emitted in all synapses.
It follows that the cell inputs can be assigned numerical coefficients (weights) corresponding to 
the number of neuro mediators isolated at one time on individual synapses.
In the mathematical model, input signals must be multiplied by these coefficients to correctly 
take into account the influence of individual input signals on the state of the nerve cell.
Synaptic weights are real numbers and can take both positive and negative values.
One of them has a stimulating effect and the other is inhibitory, making it difficult for the cell
to be stimulated by other signals.
The action of the excitatory synapse can be interpreted as assuming a positive value for 
the synaptic weight, and a negative value for the inhibitory synapse.
As a result of the input pulses reaching individual synapses and the release of appropriate
amounts of the neuro mediators, specific electrical stimulation of the cell takes place.
If the electrical imbalance is minor or if the balance of excitations and inhibitions is negative,
the cell returns to its initial state by itself, and no change can be seen in its output.

If, on the other hand, the sum of stimulations and inhibitions exceeds the cell activation
threshold, the output signal increases rapidly and a characteristic shape of
the nerve impulse is formed, sent by an axon to other neurons connected to a given cell.
This signal depends on the degree of exceeding the threshold.
The cell works on the principle: all or nothing. After fulfilling his role, the neuro mediators
are removed. The mechanism of its removal is either absorbed by the cell,
broken down, or moved beyond the synaptic area.
It stays at the same time as generating an impulse by the nerve cell the refraction
process is running.
It is a rapid increase in the cell activation threshold to the infinite value, 
as a result of which, immediately after generating the impulse, the neuron will not be able 
to generate the next one, even with strong stimulation. This state persists for some time Ar,
called absolute refraction.
This period is followed by a period of relative refraction, delta t, in which the operating
threshold returns to its resting value. In the period of At.
the cell can be stimulated, but with the use of stronger forces.
Usually in real processes the following relation Ar Â»At is fulfilled.

%--------------------------------------------------------------------------------------------------
\FloatBarrier
\subsection{Mathematical model of neural network}


%==================================================================================================
\FloatBarrier
\section{Representation in computer}

%==================================================================================================
\FloatBarrier
\section{Learining algorithms}

%==================================================================================================
\FloatBarrier
\section{Neuroevolution for agumented topologies}
NeuroEvolution of Augmenting Topologies (NEAT) is a genetic algorithm based on the use of three 
key techniques: tracing the history of genes, applying species division, and developing the 
topology of a neural network. 
In NEAT, genetic coding is used to record information about the structure of the neural network. 
It was designed in such a way as to allow easy assembly of genes during crossbreeding. 
Genomes are a linear representation of a neural network. Each genome is made up of two lists, 
one representing the genes for the nodes of the network and the other representing the 
genes for existing connections between the nodes. Node genes provide information about network 
entrances, nodes in the hidden layer, and network exit. 
Each of the connection genes contains information about the nodes between which the connection 
exists, the connection weight value, whether the connection is active or not, 
and has an identification number assigned. 
Mutations in the NEAT algorithm can change both the value of the weight of a given connection and 
the structure of the network. 
There are two possibilities for mutating the network structure by adding a link and by adding 
a node. 
When a link is added, a new link gene is created with a random weight value that connects the 
two nodes that did not have a link between them. 
In the case of a node addition mutation, the existing connection is split and the new node is put 
in place of the old connection, which is deactivated (this information is included in 
the connection genes). 
As a result, two new connections are added to the genome. 
The link leading to the new node is assigned a weight value of 1, and the link originating from 
the new node is assigned the weight value of the old link. 
Mutations cause genes to expand and the size of genes in a population varies. 
This fact requires an appropriate approach to the process of interbreeding of individuals from the 
population. During the process of evolution, information is gathered that tells us what genes 
correspond to genes from other individuals in a topologically diverse population. 
This information tells us the origin of each gene, so we can determine from which ancestor the 
gene was inherited. 
When a new gene is created (previously non-existent link), the Global Identification Number is 
increased and assigned to that gene. 
Hence the identification numbers represent the chronology of the emergence of new genes. 
In the case of a cross between two genomes, the descendant inherits the same identification numbers
corresponding to each gene, these numbers never change, thanks to which we have the opportunity 
to learn the history of the formation of a given unit. 
During the crossing process, genes with the same identification numbers are paired, 
they are called corresponding genes. 
Those that do not match are disjoint or redundant (depending on whether their numbers are 
within the range of the numbers of the other parent) 
If, when matching the connection genes, the given parent 'A' gene does not match the parent 'B' 
gene and the identification number of this gene is smaller from the largest parent identification 
number 'B' such a gene is disjoint. 
If the parent 'A' has non-corresponding genes and their numbers are greater than the largest gene 
number of the parent 'B', they are called redundant genes. 
Disjoint and redundant genes represent a structure that is not part of the other genome. 
When matching genes during crossbreeding, matching genes are inherited randomly 
(a gene with the same ID number is inherited from either parent 'A' or parent 'B'), 
while disjoint and redundant genes are inherited from the parent whose adjustment function results 
are greater. 
The result of the emergence of new genes and the crossing of units with different structures is 
the building of a topologically diverse population. Since entities with a smaller structure 
optimize faster than larger ones, and the fact that enlarging the network with nodes and 
connections usually lowers the result of the alignment function, newly developed structures have 
little chance of survival. 
It also results from the fact that topological diversity in the population will not be maintained. 
As a consequence, individuals with innovative changes in the structure, which in the future could 
turn out to be very positive for the course of evolution, will die out.

To maintain the diversity of the population in terms of topology, a division into species has been 
introduced, in which individuals compete with each other, having time to optimize and improve 
their structures within a given niche. 
Units are allocated to species based on their similarity in structure. 
The similarity is determined by the number of disconnected and redundant genes. 
The more disjoint genes there are, the fewer individuals are related, and therefore 
less compatible. The measure of agreement is calculated from the formula in which E 
is responsible for the number of redundant genes, D is disjointed, and the average of the 
difference in weight of the corresponding genes. 
The coefficients c1, c2, c3 are responsible for the significance of these parameters, 
N is responsible for normalization, when both genomes consist of less than 20 genes, N can be 1. 
The calculated compliance distance is compared with the established compliance threshold, 
if the threshold is exceeded, the unit is not classified into a given species. 
At each generation, genomes are allocated to species, each unit is compared in terms of 
compliance with the representatives of the species. The units representing the species are 
randomly selected genomes from the previous generation. 
If an entity from the current generation is not compatible with any existing species, 
a new species is created, so that unit becomes the representative of that species. 
In the case of genetic algorithms, as population diversity disappears, there is a tendency to 
converge to one solution, this is called genetic drift. 
To counteract this, when assigning an individual to a species, its adjustment function result is 
adjusted based on the results of the individuals in that species. 
Consequently, a given species does not make up the majority of the population, and therefore the 
entire population will not be assigned to one species. 
An important feature of the NEAT algorithm is maintaining population diversity, but the structure 
of the generated solutions is also very important in the context of the final solution. 
The ultimate goal of this model is to strive for the most optimal result. 
This is done by minimizing the dimensionality in the space of the solutions sought, therefore, 
when creating the base population, units with hidden layers are not generated. 
During the process of evolution, when mutations take place, only those structures that have a 
positive effect on the results obtained survive.
